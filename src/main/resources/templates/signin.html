<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <meta name="description" content="POS - Bootstrap Admin Template">
		<meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
        <meta name="author" content="Dreamguys - Bootstrap Admin Template">
        <meta name="robots" content="noindex, nofollow">
        <title>Saint Medic</title>
		
		<!-- Favicon -->
        <link rel="shortcut icon" type="image/x-icon" href="/assets_superAdmin/img/PastillaSinFondo.png">
		
		<!-- Bootstrap CSS -->
        <link rel="stylesheet" href="/assets_superAdmin/css/bootstrap.min.css">
		
        <!-- Fontawesome CSS -->
		<link rel="stylesheet" href="/assets_superAdmin/plugins/fontawesome/css/fontawesome.min.css">
		<link rel="stylesheet" href="/assets_superAdmin/plugins/fontawesome/css/all.min.css">
		
		<!-- Main CSS -->
        <link rel="stylesheet" href="/assets_superAdmin/css/style.css">
    </head>
    <body class="account-page">
	
		<!-- Main Wrapper -->
        <form class="main-wrapper" id="miFormulario">
			<div class="account-content">
				<div class="login-wrapper">
                    <div class="login-img">
                        <img src="/assets_superAdmin/img/LogoCentral.jpeg" alt="img" >
                    </div>
                    <div class="login-content">
                        <div class="login-userset">
                            <div class="login-logo">
                                <img src="/assets_superAdmin/img/LogoConLetras.png" alt="img">
                            </div>
                            <div class="login-userheading">
                                <h3>Inicia sesión</h3>
                                <h4>Por favor ingresa tu contraseña aquí</h4>
                            </div>
                           <div class="form-login">
                                <label>Correo</label>
                                <div class="form-addons">
                                    <input id="correo" type="email" placeholder="Ingresa tu correo" required  >
                                    <img src="/assets_superAdmin/img/icons/mail.svg" alt="img">
                                </div>
                            </div>
                            <div class="form-login">
                                <label>Contraseña</label>
                                <div class="pass-group">
                                    <input id="contrasena" type="password" class="pass-input" placeholder="Ingresa tu contraseña" required>
                                    <span class="fas toggle-password fa-eye-slash"></span>
                                </div>
                            </div>
                            <div class="form-login">
                                <div class="alreadyuser">
                                    <h4><a href="forgetpassword.html" class="hover-a">¿Olvidaste tu contraseña?</a></h4>
                                </div>
                            </div>
                            <div class="form-login">
                                <button type="submit" class="btn btn-login" onclick="redirigir(event)" >Inicia sesión</button>
                            </div>
                            <div class="signinform text-center">
                                <h4>¿No tienes una cuenta? <a href="signup.html" class="hover-a">Crea una</a></h4>
                            </div>
                            <!--
                            <div class="form-setlogin">
                                <h4>Or sign up with</h4>
                            </div>
                            <div class="form-sociallink">
                                <ul>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <img src="assets/img/icons/google.png" class="me-2" alt="google">
                                            Sign Up using Google
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);">
                                            <img src="assets/img/icons/facebook.png" class="me-2" alt="google">
                                            Sign Up using Facebook
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            -->
                        </div>
                    </div>

                </div>
			</div>
        </form>
		<!-- /Main Wrapper -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>

            $(document).ready(
                $("button").click(function () {
                    $.ajax({
                        method: "POST",
                        data: {username: $("#username").val()},
                        url: "http://localhost:8080"
                    })
                }
             )
            )

            function redirigir(event) {
                var formulario = document.getElementById("miFormulario");
                var correo = document.getElementById("correo").value;
                var contrasena = document.getElementById("contrasena").value;
                var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if(formulario.checkValidity()) {
                    event.preventDefault();
                    if (emailRegex.test(correo) && contrasena !== "") {
                        var xhr = new XMLHttpRequest ();
                        xhr.open('POST' , '/validarUsuario' , true );
                        xhr.setRequestHeader('Content-Type' , 'application/json') ;
                        xhr.onload = function () {
                            if(xhr.status === 200 ){
                                var data = JSON.stringify({username:correo , password:contrasena });
                                xhr.send(data);
                            }else{
                                Swal.fire({
                                    icon: "error",
                                    iconColor: "orange",
                                    title: "¡Correo o contraseña incorrectos!",
                                    confirmButtonColor: "#dd986a"
                                }).then((result) => {
                                    if (result.isConfirmed) {
                                        // Redirecciona a otra vista
                                        window.location.href = '/inicioSesion';
                                    }
                                });
                            }
                        }

                        xhr.onerror = function (){
                            console.error('Auxilio ');
                        }

                        switch (correo) {
                            //Redirigir a la vista paciente
                            case("primeraVez@gmail.com"):
                                window.location.href = "changePasswordFirstTime.html";
                                break;
                            case("paciente@gmail.com"):
                                window.location.href = "/ElegirSede";
                                break;
                            //Redirigir a la vista farmacista
                            case("farmacista@gmail.com"):
                                window.location.href = "pos.html";
                                break;
                            case("adminSede@gmail.com"):
                                window.location.href = "pos.html";
                                break;
                            case("superadmin@gmail.com"):
                                window.location.href = "/listaMedicamentosSuperAdmin";
                                break;
                            case("baneado@gmail.com"):
                                Swal.fire({
                                    icon: "error",
                                    iconColor: "orange",
                                    title: "Su cuenta ha sido baneada",
                                    confirmButtonColor: "#dd986a"
                                }).then((result) => {
                                    if (result.isConfirmed) {
                                        // Redirecciona a otra vista
                                        window.location.href = 'signin.html';
                                    }
                                });
                                break;
                            default:
                                if (contrasena !== "" && correo !== "") {
                                    Swal.fire({
                                        icon: "error",
                                        iconColor: "orange",
                                        title: "¡Correo o contraseña incorrectos!",
                                        confirmButtonColor: "#dd986a"
                                    }).then((result) => {
                                        if (result.isConfirmed) {
                                            // Redirecciona a otra vista
                                            window.location.href = '/inicioSesion';
                                        }
                                    });
                                }
                        }
                    }
                }
            }



        </script>

		<!-- jQuery -->
        <style>
            /* Personaliza el color del icono de error */
            .swal2-icon-error {
                color: black !important;
            }
        </style>

        <script src="/assets_superAdmin/js/jquery-3.6.0.min.js"></script>

         <!-- Feather Icon JS -->
		<script src="/assets_superAdmin/js/feather.min.js"></script>
		
		<!-- Bootstrap Core JS -->
        <script src="/assets_superAdmin/js/bootstrap.bundle.min.js"></script>
		
		<!-- Custom JS -->
		<script src="/assets_superAdmin/js/script.js"></script>

    </body>
</html>